<div class="page-container">
  <app-breadcrumb
    [links]="[
      { label: 'Bestellungen', url: '/orders' },
      { label: 'Bestellung #' + order?.id, url: '/orders/' + order?.id }
    ]"
  ></app-breadcrumb>

  <div *ngIf="order" class="order-detail-content">
    <!-- Header with Title and Actions -->
    <div class="page-header">
      <h1>
        <mat-icon>receipt</mat-icon>
        {{ getOrderDisplayName() }}
      </h1>
      <div class="header-actions">
        <button mat-stroked-button color="primary" [routerLink]="['/orders', order.id, 'edit']">
          <mat-icon>edit</mat-icon>
          Bearbeiten
        </button>
        <button mat-stroked-button color="warn" (click)="deleteOrder()">
          <mat-icon>delete</mat-icon>
          LÃ¶schen
        </button>
      </div>
    </div>

    <!-- Historical Order Banner -->
    <div *ngIf="order.is_historical" class="historical-banner">
      <mat-icon>history</mat-icon>
      <span>Historische Bestellung - Keine Auswirkung auf Materialbestand</span>
    </div>

    <!-- Main Content Grid -->
    <div class="content-grid">
      <!-- Left Column -->
      <div class="left-column">
        <app-order-info-card
          [order]="order"
          [supplier]="getSupplier(order.supplier)">
        </app-order-info-card>

        <app-order-deliveries-card
          [deliveries]="deliveries"
          (addDelivery)="openLinkDeliveryDialog()">
        </app-order-deliveries-card>
      </div>

      <!-- Right Column -->
      <div class="right-column">
        <app-order-costs-card [order]="order"></app-order-costs-card>

        <!-- Notizen Card -->
        <mat-card class="notes-card" *ngIf="order.notiz">
          <mat-card-header>
            <mat-card-title>
              <mat-icon>notes</mat-icon>
              Notizen
            </mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <p class="notes-text">{{ order.notiz }}</p>
          </mat-card-content>
        </mat-card>
      </div>
    </div>

    <!-- Materials Section (Full Width) -->
    <app-order-materials-table
      [mode]="'view'"
      [items]="order.items"
      [materialsList]="materialsList"
      [materialGroups]="materialGroups">
    </app-order-materials-table>
  </div>

  <!-- Loading State -->
  <div *ngIf="!order" class="loading-state">
    <mat-icon>hourglass_empty</mat-icon>
    <p>Laden...</p>
  </div>
</div>
