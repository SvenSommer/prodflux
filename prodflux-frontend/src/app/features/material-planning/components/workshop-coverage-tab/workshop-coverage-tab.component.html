<div class="workshop-coverage-container">
  @if (rows.length === 0) {
    <div class="empty-state">
      <p>Noch kein Plan berechnet.</p>
      <p class="hint">Erfassen Sie Produktionsziele und klicken Sie auf "Plan berechnen".</p>
    </div>
  } @else {
    <app-material-table
      [rows]="materialTableRows"
      [columns]="workshopColumns"
      [showImage]="true"
      [showCategory]="true">
      <ng-template #customColumn let-row let-column="column">
        @if (column.key.startsWith('workshop-')) {
          @if (getWorkshopData(row.data, +column.key.replace('workshop-', '')); as data) {
            <div class="workshop-coverage-data">
              <div class="coverage-header">
                <span>Bedarf</span>
                <span>Lokal</span>
                <span>Transfer</span>
                <span>Fehlmenge</span>
              </div>
              <div class="coverage-values">
                <span>{{ data.required | number:'1.0-2' }}</span>
                <span>{{ data.local | number:'1.0-2' }}</span>
                <span>{{ data.transfer | number:'1.0-2' }}</span>
                <span [class.has-shortage]="data.shortage > 0">
                  {{ data.shortage | number:'1.0-2' }}
                </span>
              </div>
            </div>
          } @else {
            <span class="no-data">â€”</span>
          }
        }
      </ng-template>
    </app-material-table>
  }
</div>
